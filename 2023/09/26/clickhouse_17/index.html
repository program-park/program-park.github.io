<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Clickhouse 常用函数总结 | 程序园</title><meta name="author" content="大Null"><meta name="copyright" content="大Null"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Cliskhouse 常用的函数语法总结，文末参考文献有官网全部函数的文档。">
<meta property="og:type" content="article">
<meta property="og:title" content="Clickhouse 常用函数总结">
<meta property="og:url" content="https://www.program-park.top/2023/09/26/clickhouse_17/index.html">
<meta property="og:site_name" content="程序园">
<meta property="og:description" content="Cliskhouse 常用的函数语法总结，文末参考文献有官网全部函数的文档。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.program-park.top/img/clickhouse/1.png">
<meta property="article:published_time" content="2023-09-26T07:47:00.000Z">
<meta property="article:modified_time" content="2023-09-26T07:57:45.026Z">
<meta property="article:author" content="大Null">
<meta property="article:tag" content="Clickhouse">
<meta property="article:tag" content="大数据">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.program-park.top/img/clickhouse/1.png"><link rel="shortcut icon" href="/img/favicon_logo/favicon.png"><link rel="canonical" href="https://www.program-park.top/2023/09/26/clickhouse_17/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":350},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":30,"languages":{"author":"作者: 大Null","link":"链接: ","source":"来源: 程序园","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: false,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Clickhouse 常用函数总结',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-09-26 15:57:45'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

document.addEventListener('pjax:send', () => {
  Pace.restart()
})
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatat_img.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">209</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">37</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">25</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="程序园"><span class="site-name">程序园</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Clickhouse 常用函数总结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2023-09-26T07:47:00.000Z" title="发表于 2023-09-26 15:47:00">2023-09-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Clickhouse/">Clickhouse</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>31分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Clickhouse 常用函数总结"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="1-算术函数">1. 算术函数</h1>
<p>  算术运算符适用于 UInt8，UInt16，UInt32，UInt64，Int8，Int16，Int32，Int64，Float32，Float64 等类型。</p>
<ul>
<li><strong>plus(a, b), a + b</strong>
<ul>
<li>计算数值的总和，也可将日期与整数进行相加；</li>
<li>在 Date 的情况下，和整数相加意味着添加相应的天数；</li>
<li>在 DateTime 的情况下，和整数相加意味着添加相应的秒数。</li>
</ul>
</li>
<li><strong>minus(a, b), a - b</strong>
<ul>
<li>计算数值之间的差，也可将日期与整数进行相减，同<code>plus</code>一样。</li>
</ul>
</li>
<li><strong>multiply(a, b), a * b</strong>
<ul>
<li>计算数值的乘积。</li>
</ul>
</li>
<li><strong>divide(a, b), a / b</strong>
<ul>
<li>计算数值的商，结果类型是浮点类型；</li>
<li>当除以 0 时，结果为<code>inf</code>，<code>-inf</code>或<code>nan</code>。</li>
</ul>
</li>
<li><strong>intDiv(a, b)</strong>
<ul>
<li>计算数值的商；</li>
<li>如果结果是正数，则向下取整；</li>
<li>如果结果是负数，则向上取整；</li>
<li>如果除数是 0 或用最小除数(<code>-9223372036854775808</code>)除以 -1 时，则抛异常。</li>
</ul>
</li>
<li><strong>intDivOrZero(a, b)</strong>
<ul>
<li>用法与<code>intDiv</code>相同；</li>
<li>区别在于它在除以零或将最小负数除以 -1 时返回零。</li>
</ul>
</li>
<li><strong>modulo(a, b), a % b</strong>
<ul>
<li>计算除法后的余数；</li>
<li>如果类型是整数，则结果类型也是整数；</li>
<li>如果其中一个参数是浮点数，则结果类型也是浮点数；</li>
<li>除以 0 或将最小负数除以 -1 时抛出异常。</li>
</ul>
</li>
<li><strong>moduloOrZero(a, b)</strong>
<ul>
<li>用法与<code>modulo</code>相同；</li>
<li>区别在于它在除以零或将最小负数除以 -1 时返回零。</li>
</ul>
</li>
<li><strong>negate(a), -a</strong>
<ul>
<li>计算数值的相反数。</li>
</ul>
</li>
<li><strong>abs(a)</strong>
<ul>
<li>计算数值的绝对值；</li>
<li>对于无符号类型，它不执行任何操作（个人觉得这句话是废话，感兴趣的可以自己去测试下无符号类型<code>toUInt8(-257)</code>）；</li>
<li>对于有符号整数类型，它返回无符号数。</li>
</ul>
</li>
<li><strong>gcd(a, b)</strong>
<ul>
<li>计算两个值的最大公约数；</li>
<li>其中一个值为 0 时抛出异常。</li>
</ul>
</li>
<li><strong>lcm(a, b)</strong>
<ul>
<li>计算两个值的最小公倍数；</li>
<li>其中一个值为 0 时抛出异常。</li>
</ul>
</li>
<li><strong>max2(a, b)</strong>
<ul>
<li>比较两个值并返回最大值，返回值为<code>Float64</code>类型。</li>
</ul>
</li>
<li><strong>min2(a, b)</strong>
<ul>
<li>比较两个值并返回最小值，返回值为<code>Float64</code>类型。</li>
</ul>
</li>
</ul>
<h1 id="2-比较运算">2. 比较运算</h1>
<p>  比较运算符始终返回 0 或 1 (UInt8)。<br>
  可以比较以下几种类型：</p>
<ul>
<li>数字</li>
<li>String 和 FixedString</li>
<li>日期</li>
<li>日期时间</li>
</ul>
<p>  以上每组内的类型均可互相比较，但是不同组的类型间不能进行比较。</p>
<ul>
<li><strong>equals(a, b)，a = b，a == b</strong>
<ul>
<li>等于</li>
</ul>
</li>
<li><strong>notEquals(a, b)，a != b，a &lt;&gt; b</strong>
<ul>
<li>不等于</li>
</ul>
</li>
<li><strong>less(a, b)，a &lt; b</strong>
<ul>
<li>小于</li>
</ul>
</li>
<li><strong>greater(a, b)，a &gt; b</strong>
<ul>
<li>大于</li>
</ul>
</li>
<li><strong>lessOrEquals(a, b)，a &lt;= b</strong>
<ul>
<li>小于等于</li>
</ul>
</li>
<li><strong>greaterOrEquals(a, b)，a &gt;= b</strong>
<ul>
<li>大于等于</li>
</ul>
</li>
</ul>
<h1 id="3-逻辑函数">3. 逻辑函数</h1>
<p>  逻辑函数可以接受任何数字类型的参数，并返回<code>UInt8</code>类型的 0 或 1。<br>
  当向函数传递 0 时，函数将判定为<code>false</code>，任何其他非 0 的值都将被判定为<code>true</code>。</p>
<ul>
<li><strong>and(a, b, …)，a AND b AND …</strong>
<ul>
<li>与，计算两个或多个值之间的逻辑与结果，如果有条件为 0，则结果为 0，如果有条件为<code>NULL</code>，则结果为<code>NULL</code>。</li>
</ul>
</li>
<li><strong>or(a, b, …)，a OR b OR …</strong>
<ul>
<li>或，计算两个或多个值之间的逻辑或结果。如果有条件为 1，则结果为 1，如果有条件为<code>NULL</code>，则结果为<code>NULL</code>。</li>
</ul>
</li>
<li><strong>not(a)</strong>
<ul>
<li>非，值为 0 时返回 1，值为非 0 时返回 0，值为<code>NULL</code>时返回<code>NULL</code>。</li>
</ul>
</li>
<li><strong>xor(a, b, …)</strong>
<ul>
<li>异或。</li>
</ul>
</li>
</ul>
<h1 id="4-数组函数">4. 数组函数</h1>
<ul>
<li><strong>empty()</strong>
<ul>
<li>检测输入的数组是否为空，空数组返回 1，非空数组返回 0。</li>
</ul>
</li>
<li><strong>notEmpty()</strong>
<ul>
<li>检测输入的数组是否非空，空数组返回 0，非空数组返回 1。</li>
</ul>
</li>
<li><strong>length()</strong>
<ul>
<li>返回数组中的元素个数，结果类型是<code>UInt64</code>，该函数也适用于字符串。</li>
</ul>
</li>
<li><strong>range(end)，range(start, end, step)</strong>
<ul>
<li>返回一个以<code>step</code>作为增量步长的从<code>start</code>到<code>end-1</code>的整形数字数组；</li>
<li>所有参数 start、end、step 必须属于以下几种类型之一：UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64。</li>
</ul>
</li>
<li><strong>array(x1, x2, …)</strong>
<ul>
<li>使用函数的参数作为数组元素创建一个数组；</li>
<li>参数必须是常量，并且具有最小公共类型的类型。</li>
</ul>
</li>
<li><strong>arrayConcat(arr1, arr2, …)</strong>
<ul>
<li>合并参数中传递的所有数组。</li>
</ul>
</li>
<li><strong>arrayElement(arr, n)，arr[n]</strong>
<ul>
<li>获取数组<code>arr</code>中索引为<code>n</code>的元素，<code>n</code>必须是整数类型；</li>
<li>如果索引超出数组的长度，则返回默认值（数字为 0，字符串为空字符串）。</li>
</ul>
</li>
<li><strong>has(arr, elem)</strong>
<ul>
<li>判断数组<code>arr</code>中是否存在元素<code>elem</code>，如果存在，则返回 1，不存在返回 0。</li>
</ul>
</li>
<li><strong>hasAll(arr1, arr2)</strong>
<ul>
<li>判断<code>arr2</code>是否是<code>arr1</code>的子集，如果是返回 1，不是返回 0；</li>
<li>空数组是任何数组的子集，<code>NULL</code>在数组中作为元素值进行处理。</li>
</ul>
</li>
<li><strong>hasAny(arr1, arr2)</strong>
<ul>
<li>判断两个数组是否存在交集，如果存在返回 1，不存在返回 0。</li>
</ul>
</li>
<li><strong>hasSubstr(arr1, arr2)</strong>
<ul>
<li>判断<code>arr2</code>的所有元素是否以相同的顺序存在于<code>arr1</code>中，如果存在返回 1，不存在返回 0。</li>
</ul>
</li>
<li><strong>indexOf(arr, x)</strong>
<ul>
<li>返回数组中第一个<code>x</code>元素的索引（从 1 开始计算），如果<code>x</code>不存在该数组中则返回 0。</li>
</ul>
</li>
<li><strong>countEqual(arr, x)</strong>
<ul>
<li>返回数组中等于<code>x</code>元素的个数。</li>
</ul>
</li>
<li><strong>arrayEnumerate(arr)</strong>
<ul>
<li>返回数组元素下标，如：<code>Array[1,2,3,...,length(arr)]</code>。</li>
</ul>
</li>
<li><strong>arrayEnumerateUniq(arr1, arr2, …)</strong>
<ul>
<li>返回与数组大小相同的数组，其中每个元素表示与其下标对应的原数组元素在原数组中出现的次数。如：<code>arrayEnumerateUniq([10,20,10,30]) =  [1,1,2,1]</code>；</li>
<li>也适用于参数大小相同的多个数组，这种情况下，对参数中所有数组的相同位置的元素进行统计次数，如：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayEnumerateUniq(</span><br><span class="line">    [<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;1&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>]</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayPopBack(arr)</strong>
<ul>
<li>删除数组的最后一项。</li>
</ul>
</li>
<li><strong>arrayPopFront(arr)</strong>
<ul>
<li>删除数组的第一项。</li>
</ul>
</li>
<li><strong>arrayPushBack(arr, x)</strong>
<ul>
<li>将元素<code>x</code>添加到数组的末尾；</li>
<li>只能将数字添加到数字类型的数组中，字符串添加到字符串数组中。</li>
</ul>
</li>
<li><strong>arrayPushFront(arr, x)</strong>
<ul>
<li>将元素<code>x</code>添加到数组的开头；</li>
<li>只能将数字添加到数字类型的数组中，字符串添加到字符串数组中。</li>
</ul>
</li>
<li><strong>arrayResize(arr, size[, extender])</strong>
<ul>
<li>更改数组的长度，将数组更改成长度为<code>size</code>的数组；</li>
<li>如果<code>size</code>小于数组的原大小，则数组从右侧截断；</li>
<li>如果<code>size</code>大于数组的原大小，则使用<code>extender</code>值或数组项的数据类型的默认值将数组扩展到右侧。</li>
</ul>
</li>
<li><strong>arraySlice(arr, offset[, length])</strong>
<ul>
<li>返回一个子数组，包含从指定位置的指定长度的元素；</li>
<li><code>offset</code>表示数组的偏移。正值表示左侧的偏移量，负值表示右侧的缩进量，下标从 1 开始计算；</li>
<li><code>length</code>表示子数组的长度，如果指定负值，则该函数返回<code>[offset，array_length-length]</code>，如果省略该值，则该函数返回<code>[offset，the_end_of_array]</code>。</li>
<li>示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arraySlice([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], <span class="number">-1</span>)		# [<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arraySlice([<span class="number">1</span>, <span class="number">2</span>, <span class="keyword">NULL</span>, <span class="number">4</span>, <span class="number">5</span>], <span class="number">2</span>, <span class="number">3</span>)	# [<span class="number">2</span>,<span class="keyword">NULL</span>,<span class="number">4</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arraySort([func,] arr, …)</strong>
<ul>
<li>对数组<code>arr</code>进行升序排序，如果指定了<code>func</code>函数，则排序顺序由<code>func</code>函数的调用结果决定。如果<code>func</code>接受多个参数，那么<code>arraySort</code>函数也将解析与<code>func</code>函数参数相同数量的数组参数。</li>
<li><code>NULL</code>，<code>NaN</code>和<code>Inf</code>的排序顺序：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arraySort([<span class="number">1</span>, nan, <span class="number">2</span>, <span class="keyword">NULL</span>, <span class="number">3</span>, nan, <span class="number">-4</span>, <span class="keyword">NULL</span>, inf, <span class="operator">-</span>inf])</span><br><span class="line">  </span><br><span class="line">[<span class="operator">-</span>inf,<span class="number">-4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,inf,nan,nan,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><code>arraySort</code>是高阶函数，可以将<code>lambda</code>函数作为第一个参数传递给它。在这种情况下，排序顺序由<code>lambda</code>函数的调用结果决定，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arraySort((x) <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">-</span>x, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">[<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
对于原数组的每个元素，<code>lambda</code>函数返回排序键，即<code>[1 -&gt; -1, 2 -&gt; -2, 3 -&gt; -3]</code>。由于<code>arraySort</code>函数按升序对键进行排序，因此结果为<code>[3,2,1]</code>。所以，<code>(x) -&gt; -x</code> <code>lambda</code>函数将排序设置为降序。<br>
<code>lambda</code>函数可以接受多个参数。在这种情况下，需要为<code>arraySort</code>传递与<code>lambda</code>参数个数相同的数组。函数使用第一个输入的数组中的元素组成返回结果，使用接下来传入的数组作为排序键。示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arraySort((x, y) <span class="operator">-</span><span class="operator">&gt;</span> y, [<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;world&#x27;</span>], [<span class="number">2</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">[&quot;world&quot;,&quot;hello&quot;]</span><br></pre></td></tr></table></figure>
这里，在第二个数组<code>[2, 1]</code>中定义了第一个数组<code>['hello'，'world']</code>的相应元素的排序键，即<code>['hello' -&gt; 2，'world' -&gt; 1]</code>。 由于<code>lambda</code>函数中没有使用<code>x</code>，因此源数组中的实际值不会影响结果的顺序。所以，<code>'world'</code>将是结果中的第一个元素，<code>'hello'</code>将是结果中的第二个元素。其他示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arraySort((x, y) <span class="operator">-</span><span class="operator">&gt;</span> y, [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], [<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>])	# [<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arraySort((x, y) <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">-</span> y, [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])	# [<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayReverseSort([func,] arr, …)</strong>
<ul>
<li>以降序对<code>arr</code>数组的元素进行排序。如果指定了<code>func</code>函数，则排序顺序由<code>func</code>函数的调用结果决定。如果<code>func</code>接受多个参数，那么<code>arrayReverseSort</code>函数也将解析与<code>func</code>函数参数相同数量的数组作为参数。具体用法同<code>arraySort</code>一样。</li>
</ul>
</li>
<li><strong>arrayUniq(arr, …)</strong>
<ul>
<li>如果传递一个参数，则计算数组中不同元素的数量，如果传递了多个参数，则它计算多个数组中相应位置的不同元素元组的数量；</li>
<li>如果要获取数组中唯一项的列表，可以使用<code>arrayReduce('groupUniqArray'，arr)</code>。</li>
</ul>
</li>
<li><strong>arrayJoin(arr)</strong>
<ul>
<li>行转列，对数组进行展开操作。示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayJoin([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayDifference(arr)</strong>
<ul>
<li>计算相邻数组元素之间的差异。返回一个数组，其中第一个元素为<code>0</code>，第二个是<code>arr[1]-arr[0]</code>之差等。返回的数组中元素的类型由减法的类型推断规则确定（例如<code>UInt8-UInt8=Int16</code>）。示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayDifference([<span class="number">1</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">-3</span>])</span><br><span class="line"></span><br><span class="line">[<span class="number">0</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">-12</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayDistinct(arr)</strong>
<ul>
<li>返回一个包含所有数组中不同元素的数组。示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayDistinct([<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayEnumerateDense(arr)</strong>
<ul>
<li>返回与源数组大小相同的数组，指示每个元素首次出现在源数组中的位置。示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayEnumerateDense([<span class="number">10</span>, <span class="number">20</span>, <span class="number">10</span>, <span class="number">30</span>])</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayIntersect(arr, …)</strong>
<ul>
<li>返回所有数组元素的交集。示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayIntersect([<span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayReduce(agg_func, arr1, arr2, …, arrN)</strong>
<ul>
<li>将聚合函数应用于数组元素并返回其结果。聚合函数的名称以单引号<code>'max'</code>、<code>'sum'</code>中的字符串形式传递，使用带参数的聚合函数时，参数在括号中的函数名称后写明，如：<code>'uniqUpTo(6)'</code>。  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayReduce(<span class="string">&#x27;max&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])		# <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayReduce(<span class="string">&#x27;maxIf&#x27;</span>, [<span class="number">3</span>, <span class="number">5</span>], [<span class="number">1</span>, <span class="number">0</span>])	# <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayReduce(<span class="string">&#x27;uniqUpTo(3)&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>])	# <span class="number">4</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayReduceInRanges(agg_func, ranges, arr1, arr2, …, arrN)</strong>
<ul>
<li>将聚合函数应用于给定范围内的数组元素，并返回一个包含与每个范围对应的结果的数组。该函数将返回与多个<code>arrayReduce(agg_func,arraySlice(arr1,index,length),...)</code>相同的结果；</li>
<li><code>ranges</code>指要聚合的范围应该是元组为元素的数组，其中包含每个索引和长度范围，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayReduceInRanges(</span><br><span class="line">    <span class="string">&#x27;sum&#x27;</span>,</span><br><span class="line">    [(<span class="number">1</span>, <span class="number">5</span>), (<span class="number">2</span>, <span class="number">3</span>), (<span class="number">3</span>, <span class="number">4</span>), (<span class="number">4</span>, <span class="number">4</span>)],</span><br><span class="line">    [<span class="number">1000000</span>, <span class="number">200000</span>, <span class="number">30000</span>, <span class="number">4000</span>, <span class="number">500</span>, <span class="number">60</span>, <span class="number">7</span>]</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">[<span class="number">1234500</span>,<span class="number">234000</span>,<span class="number">34560</span>,<span class="number">4567</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayReverse(arr)</strong>
<ul>
<li>返回一个与原始数组大小相同、元素相反的数组，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayReverse([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">[<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayFlatten(arr, …)</strong>
<ul>
<li>将嵌套的数组展平，适用于任何深度的嵌套数组，不会更改已经展平的数组，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  flatten([[[<span class="number">1</span>]], [[<span class="number">2</span>], [<span class="number">3</span>]]])</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayCompact(arr)</strong>
<ul>
<li>从数组中删除连续的重复元素。结果值的顺序由源数组中的顺序决定，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayCompact([<span class="number">1</span>, <span class="number">1</span>, nan, nan, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>,nan,<span class="number">2</span>,<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayZip(arr1, arr2, …, arrN)</strong>
<ul>
<li>将多个数组组合成一个数组，返回一个将原数组中的元素分组为元组的数组。元组中的数据类型与输入数组的类型相同，并且与传递数组的顺序相同，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayZip([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>], [<span class="number">5</span>, <span class="number">2</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>,<span class="number">5</span>),(<span class="string">&#x27;b&#x27;</span>,<span class="number">2</span>),(<span class="string">&#x27;c&#x27;</span>,<span class="number">1</span>)]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayMap(func, arr1, …)</strong>
<ul>
<li>将从<code>func</code>函数的原始应用中获得的数组返回给<code>arr</code>数组中的每个元素，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayMap(x <span class="operator">-</span><span class="operator">&gt;</span> (x <span class="operator">+</span> <span class="number">2</span>), [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br></pre></td></tr></table></figure>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayMap(</span><br><span class="line">    (x, y, z) <span class="operator">-</span><span class="operator">&gt;</span> (x, y, z),</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">    [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">[(<span class="number">1</span>,<span class="number">4</span>,<span class="number">7</span>),(<span class="number">2</span>,<span class="number">5</span>,<span class="number">8</span>),(<span class="number">3</span>,<span class="number">6</span>,<span class="number">9</span>)]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayFilter(func, arr1, …)</strong>
<ul>
<li>返回一个仅包含<code>arr1</code>中的元素的数组，其中<code>func</code>返回的值不是 0，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayFilter(x <span class="operator">-</span><span class="operator">&gt;</span> x <span class="keyword">LIKE</span> <span class="string">&#x27;%World%&#x27;</span>, [<span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;abc World&#x27;</span>])</span><br><span class="line"></span><br><span class="line">[<span class="string">&#x27;abc World&#x27;</span>]</span><br></pre></td></tr></table></figure>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayFilter(</span><br><span class="line">    (i, x) <span class="operator">-</span><span class="operator">&gt;</span> x <span class="keyword">LIKE</span> <span class="string">&#x27;%World%&#x27;</span>,</span><br><span class="line">    arrayEnumerate(arr),</span><br><span class="line">    [<span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;abc World&#x27;</span>] <span class="keyword">AS</span> arr</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">[<span class="number">2</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayFill(func, arr1, …)</strong>
<ul>
<li>从第一个元素到最后一个元素扫描<code>arr1</code>，如果<code>func</code>返回 0，则用<code>arr1[i-1]</code>替换<code>arr1[i]</code>。<code>arr1</code>的第一个元素不会被替换，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayFill(</span><br><span class="line">    x <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">not</span> isNull(x),</span><br><span class="line">    [<span class="number">1</span>, <span class="keyword">null</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">14</span>, <span class="keyword">null</span>, <span class="keyword">null</span>]</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">12</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">14</span>,<span class="number">14</span>,<span class="number">14</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayReverseFill(func, arr1, …)</strong>
<ul>
<li>从最后一个元素到第一个元素扫描<code>arr1</code>，如果<code>func</code>返回 0，则用<code>arr1[i+1]</code>替换<code>arr1[i]</code>。<code>arr1</code>的最后一个元素不会被替换，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayReverseFill(</span><br><span class="line">    x <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">not</span> isNull(x),</span><br><span class="line">    [<span class="number">1</span>, <span class="keyword">null</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">14</span>, <span class="keyword">null</span>, <span class="keyword">null</span>]</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">14</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arraySplit(func, arr1, …)</strong>
<ul>
<li>将<code>arr1</code>拆分为多个数组。当<code>func</code>返回 0 以外的值时，数组将在元素的左侧拆分。数组不会在第一个元素之前被拆分，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arraySplit((x, y) <span class="operator">-</span><span class="operator">&gt;</span> y, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">[[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>]]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayReverseSplit(func, arr1, …)</strong>
<ul>
<li>将<code>arr1</code>拆分为多个数组。当<code>func</code>返回 0 以外的值时，数组将在元素的右侧拆分，数组不会在最后一个元素之后被拆分。  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayReverseSplit((x, y) <span class="operator">-</span><span class="operator">&gt;</span> y, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">[[<span class="number">1</span>],[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],[<span class="number">5</span>]]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayMin([func,] arr)</strong>
<ul>
<li>返回数组中最小的元素，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayMin([<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>])	# <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayMin(x <span class="operator">-</span><span class="operator">&gt;</span> (<span class="operator">-</span> x), [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>])	# <span class="number">-4</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayMax([func,] arr)</strong>
<ul>
<li>返回数组中最大的元素，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayMax([<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>])	# <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayMax(x <span class="operator">-</span><span class="operator">&gt;</span> (<span class="operator">-</span> x), [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>])	# <span class="number">-1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arraySum([func,] arr)</strong>
<ul>
<li>返回数组中元素的总和，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arraySum([<span class="number">2</span>, <span class="number">3</span>])	# <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arraySum(x <span class="operator">-</span><span class="operator">&gt;</span> x <span class="operator">*</span> x, [<span class="number">2</span>, <span class="number">3</span>])	# <span class="number">13</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayAvg([func,] arr)</strong>
<ul>
<li>返回数组中元素的平均值，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayAvg([<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>])	# <span class="number">2.3333333333333335</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayAvg(x <span class="operator">-</span><span class="operator">&gt;</span> (x <span class="operator">*</span> x), [<span class="number">2</span>, <span class="number">4</span>])	# <span class="number">10</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayCumSum([func,] arr1, …)</strong>
<ul>
<li>返回源数组中元素的部分和的数组（运行总和）。如果指定了<code>func</code>函数，则数组元素的值在求和之前由该函数转换，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayCumSum([<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">12</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayCumSumNonNegative(arr)</strong>
<ul>
<li>与<code>arrayCumSum</code>相同，返回数组中元素的部分和的数组（运行总和），区别是当返回值包含小于零的值时，将该值替换为零，并以零参数执行后续计算。示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayCumSumNonNegative([<span class="number">1</span>, <span class="number">1</span>, <span class="number">-4</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>arrayProduct(arr)</strong>
<ul>
<li>将一个数组中的元素相乘。示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  arrayProduct([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>])</span><br><span class="line"></span><br><span class="line"><span class="number">720</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="5-时间日期函数">5. 时间日期函数</h1>
<ul>
<li><strong>timeZone()</strong>
<ul>
<li>返回服务器的时区。 如果它在分布式表的上下文中执行，那么它会生成一个普通列，其中包含与每个分片相关的值。否则它会产生一个常数值。</li>
</ul>
</li>
<li><strong>toTimeZone(value, timezone)</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为指定的时区。 时区是<code>Date/DateTime</code>类型的属性。 表字段或结果集的列的内部值（秒数）不会更改，列的类型会更改，并且其字符串表示形式也会相应更改。</li>
</ul>
</li>
<li><strong>timeZoneOf(value)</strong>
<ul>
<li>返回<code>DateTime</code>或者<code>DateTime64</code>数据类型的时区名称。<code>value</code>指类型和时间，类型为<code>DateTime</code>或者<code>DateTime64</code>。</li>
</ul>
</li>
<li><strong>toYear</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为包含年份编号（AD）的<code>UInt16</code>类型的数字。</li>
</ul>
</li>
<li><strong>toQuarter</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为包含季度编号的<code>UInt8</code>类型的数字。</li>
</ul>
</li>
<li><strong>toMonth</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为包含月份编号（1-12）的<code>UInt8</code>类型的数字。</li>
</ul>
</li>
<li><strong>toDayOfYear</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为包含一年中的某一天编号的<code>UInt16</code>（1-366）类型的数字。</li>
</ul>
</li>
<li><strong>toDayOfMonth</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为包含一月中的某一天编号的<code>UInt8</code>（1-31）类型的数字。</li>
</ul>
</li>
<li><strong>toDayOfWeek</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为包含一周中的某一天编号的<code>UInt8</code>（周一是 1，周日是 7）类型的数字。</li>
</ul>
</li>
<li><strong>toHour</strong>
<ul>
<li>将<code>DateTime</code>转换为包含 24 小时制（0-23）小时数的<code>UInt8</code>数字。</li>
</ul>
</li>
<li><strong>toMinute</strong>
<ul>
<li>将<code>DateTime</code>转换为包含一小时中分钟数（0-59）的<code>UInt8</code>数字。</li>
</ul>
</li>
<li><strong>toSecond</strong>
<ul>
<li>将<code>DateTime</code>转换为包含一分钟中秒数（0-59）的<code>UInt8</code>数字， 闰秒不计算在内。</li>
</ul>
</li>
<li><strong>toUnixTimestamp</strong>
<ul>
<li><code>toUnixTimestamp(datetime)</code>：将值转换为<code>UInt32</code>类型的 Unix 时间戳数字；</li>
<li><code>toUnixTimestamp(str, [timezone])</code>：根据时区将输入字符串转换为日期时间，并返回相应的 Unix 时间戳。</li>
</ul>
</li>
<li><strong>toStartOfYear</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>向前取整到本年的第一天， 返回<code>Date</code>类型。</li>
</ul>
</li>
<li><strong>toStartOfISOYear</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>向前取整到 ISO 本年的第一天， 返回<code>Date</code>类型。</li>
</ul>
</li>
<li><strong>toStartOfQuarter</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>向前取整到本季度的第一天， 返回<code>Date</code>类型。</li>
</ul>
</li>
<li><strong>toStartOfMonth</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>向前取整到本月的第一天， 返回<code>Date</code>类型。</li>
</ul>
</li>
<li><strong>toMonday</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>向前取整到本周的星期一， 返回<code>Date</code>类型。</li>
</ul>
</li>
<li><strong>toStartOfWeek(t [, mode])</strong>
<ul>
<li>按<code>mode</code>将<code>Date</code>或<code>DateTime</code>向前取整到最近的星期日或星期一，返回<code>Date</code>类型。 <code>mode</code>参数的工作方式与<code>toWeek()</code>的<code>mode</code>参数完全相同，<code>mode</code>默认为 0。</li>
</ul>
</li>
<li><strong>toStartOfDay</strong>
<ul>
<li>将<code>DateTime</code>向前取整到今天的开始。</li>
</ul>
</li>
<li><strong>toStartOfHour</strong>
<ul>
<li>将<code>DateTime</code>向前取整到当前小时的开始。</li>
</ul>
</li>
<li><strong>toStartOfMinute</strong>
<ul>
<li>将<code>DateTime</code>向前取整到当前分钟的开始。</li>
</ul>
</li>
<li><strong>toStartOfSecond(value [, timezone])</strong>
<ul>
<li>将<code>DateTime</code>向前取整到当前秒数的开始。</li>
</ul>
</li>
<li><strong>toStartOfFiveMinutes</strong>
<ul>
<li>将<code>DateTime</code>以五分钟为单位向前取整到最接近的时间点。</li>
</ul>
</li>
<li><strong>toStartOfFifteenMinutes</strong>
<ul>
<li>将<code>DateTime</code>以十五分钟为单位向前取整到最接近的时间点。</li>
</ul>
</li>
<li><strong>toStartOfInterval(time_or_data, 间隔x单位 [, time_zone])</strong>
<ul>
<li>这是名为<code>toStartOf*</code>的所有函数的通用函数。</li>
<li><code>toStartOfInterval(t, INTERVAL 1 year)</code>返回与<code>toStartOfYear(t)</code>相同的结果；</li>
<li><code>toStartOfInterval(t, INTERVAL 1 month)</code>返回与<code>toStartOfMonth(t)</code>相同的结果；</li>
<li><code>toStartOfInterval(t, INTERVAL 1 day)</code>返回与<code>toStartOfDay(t)</code>相同的结果；</li>
<li><code>toStartOfInterval(t, INTERVAL 15 minute)</code>返回与<code>toStartOfFifteenMinutes(t)</code>相同的结果。</li>
</ul>
</li>
<li><strong>toTime</strong>
<ul>
<li>将<code>DateTime</code>中的日期转换为一个固定的日期，同时保留时间部分。</li>
</ul>
</li>
<li><strong>toRelativeYearNum</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为年份的编号，从过去的某个固定时间点开始。</li>
</ul>
</li>
<li><strong>toRelativeQuarterNum</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为季度的数字，从过去的某个固定时间点开始。</li>
</ul>
</li>
<li><strong>toRelativeMonthNum</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为月份的编号，从过去的某个固定时间点开始。</li>
</ul>
</li>
<li><strong>toRelativeWeekNum</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为星期数，从过去的某个固定时间点开始。</li>
</ul>
</li>
<li><strong>toRelativeDayNum</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为当天的编号，从过去的某个固定时间点开始。</li>
</ul>
</li>
<li><strong>toRelativeHourNum</strong>
<ul>
<li>将<code>DateTime</code>转换为小时数，从过去的某个固定时间点开始。</li>
</ul>
</li>
<li><strong>toRelativeMinuteNum</strong>
<ul>
<li>将<code>DateTime</code>转换为分钟数，从过去的某个固定时间点开始。</li>
</ul>
</li>
<li><strong>toRelativeSecondNum</strong>
<ul>
<li>将<code>DateTime</code>转换为秒数，从过去的某个固定时间点开始。</li>
</ul>
</li>
<li><strong>toISOYear</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为包含 ISO 年份的<code>UInt16</code>类型的编号。</li>
</ul>
</li>
<li><strong>toISOWeek</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为包含 ISO 周数的<code>UInt8</code>类型的编号。</li>
</ul>
</li>
<li><strong>toWeek(date [, mode][, Timezone])</strong>
<ul>
<li>
<p>返回<code>Date</code>或<code>DateTime</code>的周数。两个参数形式可以指定星期是从星期日还是星期一开始，以及返回值应在 0 到 53 还是从 1 到 53 的范围内。如果省略了<code>mode</code>参数，则默认值为 0。 <code>toISOWeek()</code>是一个兼容函数，等效于<code>toWeek(date,3)</code>。</p>
</li>
<li>
<p>如果包含 1 月 1 日的一周在后一年度中有 4 天或更多天，则为第 1 周，否则它是上一年的最后一周，下周是第 1 周。</p>
</li>
<li>
<p>下表是<code>mode</code>参数的工作方式：</p>
<table>
<thead>
<tr>
<th>Mode</th>
<th>First day of week</th>
<th>Range</th>
<th>Week 1 is the first week …</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Sunday</td>
<td>0 - 53</td>
<td>with a Sunday in this year</td>
</tr>
<tr>
<td>1</td>
<td>Monday</td>
<td>0 - 53</td>
<td>with 4 or more days this year</td>
</tr>
<tr>
<td>2</td>
<td>Sunday</td>
<td>1 - 53</td>
<td>with a Sunday in this year</td>
</tr>
<tr>
<td>3</td>
<td>Monday</td>
<td>1 - 53</td>
<td>with 4 or more days this year</td>
</tr>
<tr>
<td>4</td>
<td>Sunday</td>
<td>0 - 53</td>
<td>with 4 or more days this year</td>
</tr>
<tr>
<td>5</td>
<td>Monday</td>
<td>0 - 53</td>
<td>with a Monday in this year</td>
</tr>
<tr>
<td>6</td>
<td>Sunday</td>
<td>1 - 53</td>
<td>with 4 or more days this year</td>
</tr>
<tr>
<td>7</td>
<td>Monday</td>
<td>1 - 53</td>
<td>with a Monday in this year</td>
</tr>
<tr>
<td>8</td>
<td>Sunday</td>
<td>1 - 53</td>
<td>contains January 1</td>
</tr>
<tr>
<td>9</td>
<td>Monday</td>
<td>1 - 53</td>
<td>contains January 1</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
<li><strong>toYearWeek(date [, mode])</strong>
<ul>
<li>返回<code>Date</code>的年和周。 结果中的年份可能因为<code>Date</code>为该年份的第一周和最后一周导致<code>Date</code>的年份不同。<code>mode</code>参数的工作方式与<code>toWeek()</code>的<code>mode</code>参数完全相同，默认为 0；</li>
<li><code>toISOYear()</code>是一个兼容函数，等效于<code>intDiv(toYearWeek(date,3),100)</code>。</li>
</ul>
</li>
<li><strong>date_trunc(unit, value [, timezone])</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>按指定的单位向前取整到最接近的时间点；</li>
<li><code>unit</code>可选值：second、minute、hour、day、week、month、quarter、year。</li>
</ul>
</li>
<li><strong>date_add(unit, value, date)</strong>
<ul>
<li>将时间间隔或日期间隔添加到提供的日期或带时间的日期。</li>
<li><code>unit</code>同<code>date_trunc()</code>一样，对应<code>value</code>的时间单位，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  date_add(<span class="keyword">YEAR</span>, <span class="number">3</span>, toDate(<span class="string">&#x27;2018-01-01&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>date_diff(‘unit’, startdate, enddate, [timezone])</strong>
<ul>
<li>返回两个日期或具有时间值的日期之间的差值；</li>
<li><code>unit</code>对应<code>value</code>的时间单位，类型为<code>String</code>，可选值：microsecond、millisecond、second、minute、hour、day、week、month、quarter、year。</li>
</ul>
</li>
<li><strong>date_sub(unit, value, date)</strong>
<ul>
<li>从提供的日期或带时间的日期中减去时间间隔或日期间隔；</li>
<li><code>unit</code>同<code>date_trunc()</code>一样，对应<code>value</code>的时间单位，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  date_sub(<span class="keyword">YEAR</span>, <span class="number">3</span>, toDate(<span class="string">&#x27;2018-01-01&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="number">2015</span><span class="number">-01</span><span class="number">-01</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>timestamp_add(date, INTERVAL value unit)</strong>
<ul>
<li>将指定的时间值与提供的日期或日期时间值相加；</li>
<li><code>unit</code>同<code>date_trunc()</code>一样，对应<code>value</code>的时间单位，类型为<code>String</code>，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  timestamp_add(toDate(<span class="string">&#x27;2018-01-01&#x27;</span>), <span class="type">INTERVAL</span> <span class="number">3</span> <span class="keyword">MONTH</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span><span class="number">-04</span><span class="number">-01</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>timestamp_sub(unit, value, date)</strong>
<ul>
<li>从提供的日期或带时间的日期中减去时间间隔；</li>
<li><code>unit</code>同<code>date_trunc()</code>一样，对应<code>value</code>的时间单位，类型为<code>String</code>，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  timestamp_sub(<span class="keyword">MONTH</span>, <span class="number">5</span>, toDateTime(<span class="string">&#x27;2018-12-18 01:02:03&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span><span class="number">-07</span><span class="number">-18</span> <span class="number">01</span>:<span class="number">02</span>:<span class="number">03</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>now([timezone])</strong>
<ul>
<li>返回当前日期和时间，可选参数<code>timezone</code>指定时区。</li>
</ul>
</li>
<li><strong>today</strong>
<ul>
<li>不接受任何参数并在请求执行时的某一刻返回当前日期（Date）， 其功能与<code>toDate(now())</code>相同。</li>
</ul>
</li>
<li><strong>yesterday</strong>
<ul>
<li>不接受任何参数并在请求执行时的某一刻返回昨天日期（Date）， 其功能与<code>today()-1</code>相同。</li>
</ul>
</li>
<li><strong>toYYYYMM</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为包含年份和月份编号的<code>UInt32</code>类型的数字（<code>YYYY*100+MM</code>）。</li>
</ul>
</li>
<li><strong>toYYYYMMDD</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为包含年份和月份编号的<code>UInt32</code>类型的数字（<code>YYYY*10000+MM*100+DD</code>）。</li>
</ul>
</li>
<li><strong>toYYYYMMDDhhmmss</strong>
<ul>
<li>将<code>Date</code>或<code>DateTime</code>转换为包含年份和月份编号的<code>UInt64</code>类型的数字（<code>YYYY*10000000000+MM*100000000+DD*1000000+hh*10000+mm*100+ss</code>）。</li>
</ul>
</li>
<li><strong>addYears, addMonths, addWeeks, addDays, addHours, addMinutes, addSeconds, addQuarters</strong>
<ul>
<li>函数将一段时间间隔添加到<code>Date/DateTime</code>，然后返回<code>Date/DateTime</code>，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span></span><br><span class="line">    toDate(<span class="string">&#x27;2018-01-01&#x27;</span>) <span class="keyword">AS</span> <span class="type">date</span>,</span><br><span class="line">    toDateTime(<span class="string">&#x27;2018-01-01 00:00:00&#x27;</span>) <span class="keyword">AS</span> date_time</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    addYears(<span class="type">date</span>, <span class="number">1</span>) <span class="keyword">AS</span> add_years_with_date,</span><br><span class="line">    addYears(date_time, <span class="number">1</span>) <span class="keyword">AS</span> add_years_with_date_time</span><br><span class="line"></span><br><span class="line">┌─add_years_with_date─┬─add_years_with_date_time─┐</span><br><span class="line">│          <span class="number">2019</span><span class="number">-01</span><span class="number">-01</span> │      <span class="number">2019</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> │</span><br><span class="line">└─────────────────────┴──────────────────────────┘</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>subtractYears,subtractMonths,subtractWeeks,subtractDays,subtractours,subtractMinutes,subtractSeconds,subtractQuarters</strong>
<ul>
<li>函数将<code>Date/DateTime</code>减去一段时间间隔，然后返回<code>Date/DateTime</code>，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span></span><br><span class="line">    toDate(<span class="string">&#x27;2019-01-01&#x27;</span>) <span class="keyword">AS</span> <span class="type">date</span>,</span><br><span class="line">    toDateTime(<span class="string">&#x27;2019-01-01 00:00:00&#x27;</span>) <span class="keyword">AS</span> date_time</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    subtractYears(<span class="type">date</span>, <span class="number">1</span>) <span class="keyword">AS</span> subtract_years_with_date,</span><br><span class="line">    subtractYears(date_time, <span class="number">1</span>) <span class="keyword">AS</span> subtract_years_with_date_time</span><br><span class="line"></span><br><span class="line">┌─subtract_years_with_date─┬─subtract_years_with_date_time─┐</span><br><span class="line">│               <span class="number">2018</span><span class="number">-01</span><span class="number">-01</span> │           <span class="number">2018</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> │</span><br><span class="line">└──────────────────────────┴───────────────────────────────┘</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>timeSlots(StartTime, Duration,[, Size])</strong>
<ul>
<li>它返回一个时间数组，其中包括从从<code>StartTime</code>开始到<code>StartTime+Duration</code>秒内的所有符合<code>size</code>（以秒为单位）步长的时间点。其中<code>size</code>是一个可选参数，默认为 1800。 例如，<code>timeSlots(toDateTime('2012-01-01 12:20:00'), 600) = [toDateTime('2012-01-01 12:00:00'), toDateTime('2012-01-01 12:30:00')]</code>，这对于搜索在相应会话中综合浏览量是非常有用的。</li>
</ul>
</li>
<li><strong>formatDateTime(Time, Format[, Timezone])</strong>
<ul>
<li>
<p>函数根据给定的格式字符串来格式化时间。格式字符串必须是常量表达式，例如：单个结果列不能有多种格式字符串。</p>
</li>
<li>
<p>支持的格式修饰符：</p>
<table>
<thead>
<tr>
<th>修饰符</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>%C</td>
<td>年除以100并截断为整数(00-99)</td>
<td>20</td>
</tr>
<tr>
<td>%d</td>
<td>月中的一天，零填充（01-31)</td>
<td>02</td>
</tr>
<tr>
<td>%D</td>
<td>短MM/DD/YY日期，相当于%m/%d/%y</td>
<td>01/02/2018</td>
</tr>
<tr>
<td>%e</td>
<td>月中的一天，空格填充（ 1-31)</td>
<td>2</td>
</tr>
<tr>
<td>%F</td>
<td>短YYYY-MM-DD日期，相当于%Y-%m-%d</td>
<td>2018-01-02</td>
</tr>
<tr>
<td>%G</td>
<td>ISO周号的四位数年份格式， 从基于周的年份由ISO 8601定义 标准计算得出，通常仅对％V有用</td>
<td>2018</td>
</tr>
<tr>
<td>%g</td>
<td>两位数的年份格式，与ISO 8601一致，四位数表示法的缩写</td>
<td>18</td>
</tr>
<tr>
<td>%H</td>
<td>24小时格式（00-23)</td>
<td>22</td>
</tr>
<tr>
<td>%I</td>
<td>12小时格式（01-12)</td>
<td>10</td>
</tr>
<tr>
<td>%j</td>
<td>一年中的一天 (001-366)</td>
<td>002</td>
</tr>
<tr>
<td>%m</td>
<td>月份为十进制数（01-12)</td>
<td>01</td>
</tr>
<tr>
<td>%M</td>
<td>分钟(00-59)</td>
<td>33</td>
</tr>
<tr>
<td>%n</td>
<td>换行符(&quot;)</td>
<td></td>
</tr>
<tr>
<td>%p</td>
<td>AM或PM指定</td>
<td>PM</td>
</tr>
<tr>
<td>%Q</td>
<td>季度（1-4)</td>
<td>1</td>
</tr>
<tr>
<td>%R</td>
<td>24小时HH:MM时间，相当于%H:%M</td>
<td>22:33</td>
</tr>
<tr>
<td>%S</td>
<td>秒 (00-59)</td>
<td>44</td>
</tr>
<tr>
<td>%t</td>
<td>水平制表符(’)</td>
<td></td>
</tr>
<tr>
<td>%T</td>
<td>ISO8601时间格式(HH:MM:SS)，相当于%H:%M:%S</td>
<td>22:33:44</td>
</tr>
<tr>
<td>%u</td>
<td>ISO8601工作日为数字，星期一为1(1-7)</td>
<td>2</td>
</tr>
<tr>
<td>%V</td>
<td>ISO8601周编号(01-53)</td>
<td>01</td>
</tr>
<tr>
<td>%w</td>
<td>工作日为十进制数，周日为0(0-6)</td>
<td>2</td>
</tr>
<tr>
<td>%y</td>
<td>年份，最后两位数字（00-99)</td>
<td>18</td>
</tr>
<tr>
<td>%Y</td>
<td>年</td>
<td>2018</td>
</tr>
<tr>
<td>%%</td>
<td>%符号</td>
<td>%</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>示例：</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  formatDateTime(toDate(<span class="string">&#x27;2010-01-04&#x27;</span>), <span class="string">&#x27;%g&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>dateName(date_part, date)</strong>
<ul>
<li>返回日期的指定部分；</li>
<li><code>date_part</code>类型为<code>String</code>，可为 ‘year’, ‘quarter’, ‘month’, ‘week’, ‘dayofyear’, ‘day’, ‘weekday’, ‘hour’, ‘minute’, ‘second’；</li>
<li>示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> toDateTime(<span class="string">&#x27;2021-04-14 11:22:33&#x27;</span>) <span class="keyword">AS</span> date_value</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  dateName(<span class="string">&#x27;year&#x27;</span>, date_value),</span><br><span class="line">  dateName(<span class="string">&#x27;month&#x27;</span>, date_value),</span><br><span class="line">  dateName(<span class="string">&#x27;day&#x27;</span>, date_value)</span><br><span class="line"></span><br><span class="line">┌─dateName(<span class="string">&#x27;year&#x27;</span>, date_value)─┬─dateName(<span class="string">&#x27;month&#x27;</span>, date_value)─┬─dateName(<span class="string">&#x27;day&#x27;</span>, date_value)─┐</span><br><span class="line">│ <span class="number">2021</span>                         │ April                         │ <span class="number">14</span>                          │</span><br><span class="line">└──────────────────────────────┴───────────────────────────────┴─────────────────────────────</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>FROM_UNIXTIME</strong>
<ul>
<li>当只有单个整数类型的参数时，它的作用与<code>toDateTime</code>相同，并返回<code>DateTime</code>类型，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  FROM_UNIXTIME(<span class="number">423543535</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">1983</span><span class="number">-06</span><span class="number">-04</span> <span class="number">10</span>:<span class="number">58</span>:<span class="number">55</span></span><br></pre></td></tr></table></figure>
</li>
<li>当有两个参数时，第一个是整型或<code>DateTime</code>，第二个是常量格式字符串，它的作用与<code>formatDateTime</code>相同，并返回<code>String</code>类型，示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  FROM_UNIXTIME(<span class="number">1234334543</span>, <span class="string">&#x27;%Y-%m-%d %R:%S&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">2009</span><span class="number">-02</span><span class="number">-11</span> <span class="number">14</span>:<span class="number">42</span>:<span class="number">23</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="6-字典函数">6. 字典函数</h1>
<ul>
<li><strong>dictGetString(‘dict_name’, ‘attr_name’, id)</strong>
<ul>
<li>使用<code>id</code>键获取<code>dict_name</code>字典中<code>attr_name</code>属性的值。<code>dict_name</code>和<code>attr_name</code>是常量字符串。<code>id</code>必须是<code>UInt64</code>。 如果字典中没有<code>id</code>键，则返回字典描述中指定的默认值。</li>
</ul>
</li>
<li><strong>dictGetTOrDefault(‘dict_name’, ‘attr_name’, id, default)</strong>
<ul>
<li>与<code>dictGetString()</code>函数相同，但默认值取自函数的最后一个参数。</li>
</ul>
</li>
<li><strong>dictIsIn(‘dict_name’, child_id, ancestor_id)</strong>
<ul>
<li>对于<code>dict_name</code>分层字典，查找<code>child_id</code>键是否位于<code>ancestor_id</code>内（或匹配<code>ancestor_id</code>）。返回<code>UInt8</code>。</li>
</ul>
</li>
<li><strong>dictGetHierarchy(‘dict_name’, id)</strong>
<ul>
<li>对于<code>dict_name</code>分层字典，返回从<code>id</code>开始并沿父元素链继续的字典键数组，返回 Array（UInt64）。</li>
</ul>
</li>
<li><strong>dictHas(‘dict_name’, id)</strong>
<ul>
<li>检查字典是否存在指定的<code>id</code>。如果不存在，则返回 0，如果存在，则返回 1。</li>
</ul>
</li>
</ul>
<h1 id="7-Nullable处理函数">7. Nullable处理函数</h1>
<ul>
<li><strong>isNull(x)</strong>
<ul>
<li><code>x</code>为一个非复合数据类型的值；</li>
<li>如果为<code>NULL</code>返回 1，不为<code>NULL</code>返回 0。</li>
</ul>
</li>
<li><strong>isNotNull(x)</strong>
<ul>
<li>同<code>isNull()</code>函数作用相反。</li>
</ul>
</li>
<li><strong>coalesce(x,…)</strong>
<ul>
<li>检查从左到右是否传递了<code>NULL</code>参数并返回第一个非<code>NULL</code>参数；</li>
<li>如果所有参数都是<code>NULL</code>则返回<code>NULL</code>。</li>
</ul>
</li>
<li><strong>ifNull(x,alt)</strong>
<ul>
<li>如果第一个参数为<code>NULL</code>，则返回第二个参数的值，否则返回第一个值。</li>
</ul>
</li>
<li><strong>nullIf(x, y)</strong>
<ul>
<li>如果参数相等，则返回<code>NULL</code>，<code>x</code>和<code>y</code>类型必须兼容，否则抛出异常；</li>
<li>如果参数不相等，则返回<code>x</code>。</li>
</ul>
</li>
<li><strong>assumeNotNull(x)</strong>
<ul>
<li>将可为空类型的值转换为非<code>Nullable</code>类型的值；</li>
<li>如果<code>x</code>不为<code>NULL</code>，返回<code>x</code>，如果<code>x</code>为<code>NULL</code>，则返回该类型的默认值。</li>
</ul>
</li>
<li><strong>toNullable(x)</strong>
<ul>
<li>将参数的类型转换为<code>Nullable</code>。</li>
</ul>
</li>
</ul>
<h1 id="8-IP函数">8. IP函数</h1>
<ul>
<li><strong>IPv4NumToString(num)</strong>
<ul>
<li>接受一个<code>UInt32</code>（大端）表示的<code>IPv4</code>的地址，返回相应<code>IPv4</code>的字符串表现形式，格式为<code>A.B.C.D</code>（以点分割的十进制数字）。</li>
</ul>
</li>
<li><strong>IPv4StringToNum(s)</strong>
<ul>
<li>与<code>IPv4NumToString</code>函数相反。如果<code>IPv4</code>地址格式无效，则返回 0。</li>
</ul>
</li>
<li><strong>IPv4NumToStringClassC(num)</strong>
<ul>
<li>与<code>IPv4NumToString</code>类似，但使用<code>xxx</code>替换最后一个字节。</li>
</ul>
</li>
<li><strong>IPv6NumToString(x)</strong>
<ul>
<li>接受<code>FixedString(16)</code>类型的二进制格式的<code>IPv6</code>地址。以文本格式返回此地址的字符串。<code>IPv6</code>映射的<code>IPv4</code>地址以<code>::ffff:111.222.33</code>。例如：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">	IPv6NumToString(toFixedString(unhex(<span class="string">&#x27;2A0206B8000000000000000000000011&#x27;</span>), <span class="number">16</span>)) <span class="keyword">AS</span> addr</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>a02:<span class="number">6</span>b8::<span class="number">11</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>IPv6StringToNum(s)</strong>
<ul>
<li>与<code>IPv6NumToString</code>相反。如果<code>IPv6</code>地址格式无效，则返回空字节字符串。 十六进制可以是大写的或小写的。</li>
</ul>
</li>
<li><strong>IPv4ToIPv6(x)</strong>
<ul>
<li>接受一个<code>UInt32</code>类型的<code>IPv4</code>地址，返回<code>FixedString(16)</code>类型的<code>IPv6</code>地址。例如：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	IPv6NumToString(IPv4ToIPv6(IPv4StringToNum(<span class="string">&#x27;192.168.0.1&#x27;</span>))) <span class="keyword">AS</span> addr</span><br><span class="line"></span><br><span class="line">::ffff:<span class="number">192.168</span><span class="number">.0</span><span class="number">.1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>toIPv4(字符串)</strong>
<ul>
<li><code>IPv4StringToNum()</code>的别名，它采用字符串形式的<code>IPv4</code>地址并返回<code>IPv4</code>类型的值，该二进制值等于<code>IPv4StringToNum()</code>返回的值。</li>
</ul>
</li>
<li><strong>toIPv6(字符串)</strong>
<ul>
<li><code>IPv6StringToNum()</code>的别名，它采用字符串形式的<code>IPv6</code>地址并返回<code>IPv6</code>类型的值，该二进制值等于<code>IPv6StringToNum()</code>返回的值。</li>
</ul>
</li>
</ul>
<h1 id="9-字符串拆分合并函数">9. 字符串拆分合并函数</h1>
<ul>
<li><strong>splitByChar(分隔符，s)</strong>
<ul>
<li>将字符串以<code>separator</code>拆分成多个子串。<code>separator</code>必须为仅包含一个字符的字符串常量， 返回拆分后的子串的数组；</li>
<li>如果分隔符出现在字符串的开头或结尾，或者如果有多个连续的分隔符，则将在对应位置填充空的子串。</li>
</ul>
</li>
<li><strong>splitByString(分隔符，s)</strong>
<ul>
<li>与<code>splitByChar</code>相同，但它使用多个字符的字符串作为分隔符。 该字符串必须为非空。</li>
</ul>
</li>
<li><strong>arrayStringConcat(arr[,分隔符])</strong>
<ul>
<li>使用<code>separator</code>将数组中列出的字符串拼接起来。<code>separator</code>是一个可选参数：一个常量字符串，默认情况下设置为空字符串。 返回拼接后的字符串。</li>
</ul>
</li>
<li><strong>alphaTokens(s)</strong>
<ul>
<li>从范围<code>a-z</code>和<code>A-Z</code>中选择连续字节的子字符串，返回子字符串数组；</li>
<li>示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	alphaTokens(<span class="string">&#x27;abca1abc&#x27;</span>)</span><br><span class="line"></span><br><span class="line">[<span class="string">&#x27;abca&#x27;</span>,<span class="string">&#x27;abc&#x27;</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="10-字符串函数">10. 字符串函数</h1>
<ul>
<li><strong>empty</strong>
<ul>
<li>对于空字符串返回 1，对于非空字符串返回 0。 结果类型是<code>UInt8</code>。 如果字符串包含至少一个字节，则该字符串被视为非空字符串，即使这是一个空格或空字符。 该函数也适用于数组。</li>
</ul>
</li>
<li><strong>notEmpty</strong>
<ul>
<li>对于空字符串返回 0，对于非空字符串返回 1。 结果类型是<code>UInt8</code>。 该函数也适用于数组。</li>
</ul>
</li>
<li><strong>length</strong>
<ul>
<li>返回字符串的字节长度。 结果类型是<code>UInt64</code>。 该函数也适用于数组。</li>
</ul>
</li>
<li><strong>lower, lcase</strong>
<ul>
<li>将字符串中的<code>ASCII</code>转换为小写。</li>
</ul>
</li>
<li><strong>upper, ucase</strong>
<ul>
<li>将字符串中的<code>ASCII</code>转换为大写。</li>
</ul>
</li>
<li><strong>reverse</strong>
<ul>
<li>反转字符串。</li>
</ul>
</li>
<li><strong>format(pattern, s0, s1, …)</strong>
<ul>
<li>使用常量字符串<code>pattern</code>格式化其他参数。<code>pattern</code>字符串中包含由大括号<code>&#123;&#125;</code>包围的替换字段。 未被包含在大括号中的任何内容都被视为文本内容，它将原样保留在返回值中。示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  format(<span class="string">&#x27;&#123;1&#125; &#123;0&#125; &#123;0&#125;&#123;1&#125;&#123;1&#125;&#x27;</span>, <span class="string">&#x27;World&#x27;</span>, <span class="string">&#x27;Hello&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Hello World WorldHelloHello</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>concat(s1, s2, …)</strong>
<ul>
<li>将参数中的多个字符串拼接，不带分隔符。</li>
</ul>
</li>
<li><strong>substring(s,offset,length), mid(s,offset,length), substr(s,offset,length)</strong>
<ul>
<li>以字节为单位截取指定位置字符串，返回以<code>offset</code>位置为开头，长度为<code>length</code>的子串。<code>offset</code>从1开始（与标准 SQL 相同）。<code>offset</code>和<code>length</code>参数必须是常量。</li>
</ul>
</li>
<li><strong>appendTrailingCharIfAbsent(s,c)</strong>
<ul>
<li>如果<code>s</code>字符串非空并且末尾不包含<code>c</code>字符，则将<code>c</code>字符附加到末尾。</li>
</ul>
</li>
<li><strong>endsWith(s,后缀)</strong>
<ul>
<li>返回是否以指定的后缀结尾。如果字符串以指定的后缀结束，则返回 1，否则返回 0。</li>
</ul>
</li>
<li><strong>startsWith(s，前缀)</strong>
<ul>
<li>返回是否以指定的前缀开头。如果字符串以指定的前缀开头，则返回 1，否则返回 0。</li>
</ul>
</li>
<li><strong>trimLeft(s)</strong>
<ul>
<li>返回一个字符串，用于删除左侧的空白字符。</li>
</ul>
</li>
<li><strong>trimRight(s)</strong>
<ul>
<li>返回一个字符串，用于删除右侧的空白字符。</li>
</ul>
</li>
<li><strong>trimBoth(s)</strong>
<ul>
<li>返回一个字符串，用于删除任一侧的空白字符。</li>
</ul>
</li>
</ul>
<h1 id="11-字符串替换函数">11. 字符串替换函数</h1>
<ul>
<li><strong>replaceOne(haystack, pattern, replacement)</strong>
<ul>
<li>用<code>replacement</code>子串替换<code>haystack</code>中第一次出现的<code>pattern</code>子串（如果存在）。 <code>pattern</code>和<code>replacement</code>必须是常量。</li>
</ul>
</li>
<li><strong>replaceAll(haystack, pattern, replacement), replace(haystack, pattern, replacement)</strong>
<ul>
<li>用<code>replacement</code>子串替换<code>haystack</code>中出现的所有的<code>pattern</code>子串。</li>
</ul>
</li>
<li><strong>replaceRegexpOne(haystack, pattern, replacement)</strong>
<ul>
<li>使用<code>pattern</code>正则表达式的替换。 <code>pattern</code>可以是任意一个有效的<code>re2</code>正则表达式。 如果存在与<code>pattern</code>正则表达式匹配的匹配项，仅替换第一个匹配项。 模式<code>pattern</code>可以指定为<code>replacement</code>。此模式可以包含替代<code>\0-\9</code>。 替代<code>\0</code>包含了整个正则表达式。替代<code>\1-\9</code>对应于子模式编号。要在模板中使用反斜杠<code>\</code>，请使用<code>\</code>将其转义。 另外还请记住，字符串字面值（literal）需要额外的转义。</li>
<li>示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span></span><br><span class="line">    EventDate,</span><br><span class="line">    replaceRegexpOne(toString(EventDate), <span class="string">&#x27;(\\d&#123;4&#125;)-(\\d&#123;2&#125;)-(\\d&#123;2&#125;)&#x27;</span>, <span class="string">&#x27;\\2/\\3/\\1&#x27;</span>) <span class="keyword">AS</span> res</span><br><span class="line"><span class="keyword">FROM</span> test.hits</span><br><span class="line">LIMIT <span class="number">7</span></span><br><span class="line">FORMAT TabSeparated</span><br><span class="line"></span><br><span class="line"><span class="number">2014</span><span class="number">-03</span><span class="number">-17</span>      <span class="number">03</span><span class="operator">/</span><span class="number">17</span><span class="operator">/</span><span class="number">2014</span></span><br><span class="line"><span class="number">2014</span><span class="number">-03</span><span class="number">-18</span>      <span class="number">03</span><span class="operator">/</span><span class="number">18</span><span class="operator">/</span><span class="number">2014</span></span><br><span class="line"><span class="number">2014</span><span class="number">-03</span><span class="number">-19</span>      <span class="number">03</span><span class="operator">/</span><span class="number">19</span><span class="operator">/</span><span class="number">2014</span></span><br><span class="line"><span class="number">2014</span><span class="number">-03</span><span class="number">-20</span>      <span class="number">03</span><span class="operator">/</span><span class="number">20</span><span class="operator">/</span><span class="number">2014</span></span><br><span class="line"><span class="number">2014</span><span class="number">-03</span><span class="number">-21</span>      <span class="number">03</span><span class="operator">/</span><span class="number">21</span><span class="operator">/</span><span class="number">2014</span></span><br><span class="line"><span class="number">2014</span><span class="number">-03</span><span class="number">-22</span>      <span class="number">03</span><span class="operator">/</span><span class="number">22</span><span class="operator">/</span><span class="number">2014</span></span><br><span class="line"><span class="number">2014</span><span class="number">-03</span><span class="number">-23</span>      <span class="number">03</span><span class="operator">/</span><span class="number">23</span><span class="operator">/</span><span class="number">2014</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	replaceRegexpOne(<span class="string">&#x27;Hello, World!&#x27;</span>, <span class="string">&#x27;.*&#x27;</span>, <span class="string">&#x27;\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0&#x27;</span>) <span class="keyword">AS</span> res</span><br><span class="line"></span><br><span class="line">Hello, World<span class="operator">!</span>Hello, World<span class="operator">!</span>Hello, World<span class="operator">!</span>Hello, World<span class="operator">!</span>Hello, World<span class="operator">!</span>Hello, World<span class="operator">!</span>Hello, World<span class="operator">!</span>Hello, World<span class="operator">!</span>Hello, World<span class="operator">!</span>Hello, World<span class="operator">!</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>replaceRegexpAll(haystack, pattern, replacement)</strong>
<ul>
<li>与<code>replaceRegexpOne</code>相同，但会替换所有出现的匹配项。例如：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	replaceRegexpAll(<span class="string">&#x27;Hello, World!&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;\\0\\0&#x27;</span>) <span class="keyword">AS</span> res</span><br><span class="line"></span><br><span class="line">HHeelllloo,,  WWoorrlldd<span class="operator">!</span><span class="operator">!</span></span><br></pre></td></tr></table></figure>
</li>
<li>另外，对于空子字符串，正则表达式只会进行一次替换。 示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	replaceRegexpAll(<span class="string">&#x27;Hello, World!&#x27;</span>, <span class="string">&#x27;^&#x27;</span>, <span class="string">&#x27;here: &#x27;</span>) <span class="keyword">AS</span> res</span><br><span class="line"></span><br><span class="line">here: Hello, World<span class="operator">!</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="12-聚合函数">12. 聚合函数</h1>
<ul>
<li><strong>count</strong></li>
<li><strong>min</strong></li>
<li><strong>max</strong></li>
<li><strong>sum</strong></li>
<li><strong>avg</strong></li>
<li><strong>any</strong></li>
<li><strong>argMin(arg, val)</strong>
<ul>
<li>计算<code>val</code>最小值对应的<code>arg</code>值。 如果<code>val</code>最小值存在几个不同的<code>arg</code>值，输出遇到的第一个<code>arg</code>值；</li>
<li>示例：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">┌─<span class="keyword">user</span>─────┬─salary─┐</span><br><span class="line">│ director │   <span class="number">5000</span> │</span><br><span class="line">│ manager  │   <span class="number">3000</span> │</span><br><span class="line">│ worker   │   <span class="number">1000</span> │</span><br><span class="line">└──────────┴────────┘</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	argMin(<span class="keyword">user</span>, salary), argMin(tuple(<span class="keyword">user</span>, salary), salary) <span class="keyword">FROM</span> salary;</span><br><span class="line"></span><br><span class="line">┌─argMin(<span class="keyword">user</span>, salary)─┬─argMin(tuple(<span class="keyword">user</span>, salary), salary)─┐</span><br><span class="line">│ worker               │ (<span class="string">&#x27;worker&#x27;</span>,<span class="number">1000</span>)                     │</span><br><span class="line">└──────────────────────┴─────────────────────────────────────┘</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>argMax(arg, val)</strong>
<ul>
<li>计算<code>val</code>最大值对应的<code>arg</code>值。 如果<code>val</code>最大值存在几个不同的<code>arg</code>值，输出遇到的第一个值。</li>
</ul>
</li>
<li><strong>groupArray(x)</strong>
<ul>
<li>列转行。</li>
</ul>
</li>
</ul>
<h1 id="参考文献">参考文献</h1>
<p>  【1】<a target="_blank" rel="noopener" href="https://clickhouse.com/docs/zh/sql-reference/functions">https://clickhouse.com/docs/zh/sql-reference/functions</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://www.program-park.top/">大Null</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.program-park.top/2023/09/26/clickhouse_17/">https://www.program-park.top/2023/09/26/clickhouse_17/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">此文章版权归 <a href=https://www.program-park.top/>程序园</a> 所有，如有转载，请注明来自原作者。</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Clickhouse/">Clickhouse</a><a class="post-meta__tags" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></div><div class="post_share"><div class="social-share" data-image="/img/clickhouse/1.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/10/16/reptile_3/" title="Python 爬虫基础之 Selenium 详解"><img class="cover" src="/img/reptile/1.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Python 爬虫基础之 Selenium 详解</div></div></a></div><div class="next-post pull-right"><a href="/2023/07/21/python_20/" title="Python2.7.5 环境下离线安装 pip 和第三方库"><img class="cover" src="/img/python/1.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Python2.7.5 环境下离线安装 pip 和第三方库</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/03/31/clickhouse_10/" title="ClickHouse 实时分析（九）- ClickHouse 常规优化方案"><img class="cover" src="/img/clickhouse/1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-31</div><div class="title">ClickHouse 实时分析（九）- ClickHouse 常规优化方案</div></div></a></div><div><a href="/2022/03/21/clickhouse_1/" title="ClickHouse 实时分析（一）- ClickHouse 入门"><img class="cover" src="/img/clickhouse/1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-21</div><div class="title">ClickHouse 实时分析（一）- ClickHouse 入门</div></div></a></div><div><a href="/2022/04/01/clickhouse_11/" title="ClickHouse 实时分析（十）- ClickHouse 内置语法优化详解"><img class="cover" src="/img/clickhouse/1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-01</div><div class="title">ClickHouse 实时分析（十）- ClickHouse 内置语法优化详解</div></div></a></div><div><a href="/2022/04/02/clickhouse_12/" title="ClickHouse 实时分析（十一）- ClickHouse 高性能查询优化方案"><img class="cover" src="/img/clickhouse/1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-02</div><div class="title">ClickHouse 实时分析（十一）- ClickHouse 高性能查询优化方案</div></div></a></div><div><a href="/2022/04/08/clickhouse_13/" title="ClickHouse 实时分析（十二）- ClickHouse 如何保证数据一致性"><img class="cover" src="/img/clickhouse/1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-08</div><div class="title">ClickHouse 实时分析（十二）- ClickHouse 如何保证数据一致性</div></div></a></div><div><a href="/2022/04/08/clickhouse_14/" title="ClickHouse 实时分析（十三）- ClickHouse 物化视图详解"><img class="cover" src="/img/clickhouse/1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-08</div><div class="title">ClickHouse 实时分析（十三）- ClickHouse 物化视图详解</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatat_img.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">大Null</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">209</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">37</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">25</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/program-park"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/program-park" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:lkm869666@126.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://blog.csdn.net/weixin_44758876" target="_blank" title="CSDN"><i class="fa-solid fa-c"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">网站正在优化中......</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E7%AE%97%E6%9C%AF%E5%87%BD%E6%95%B0"><span class="toc-text">1. 算术函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97"><span class="toc-text">2. 比较运算</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E9%80%BB%E8%BE%91%E5%87%BD%E6%95%B0"><span class="toc-text">3. 逻辑函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E6%95%B0%E7%BB%84%E5%87%BD%E6%95%B0"><span class="toc-text">4. 数组函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-text">5. 时间日期函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E5%AD%97%E5%85%B8%E5%87%BD%E6%95%B0"><span class="toc-text">6. 字典函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-Nullable%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="toc-text">7. Nullable处理函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-IP%E5%87%BD%E6%95%B0"><span class="toc-text">8. IP函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%86%E5%88%86%E5%90%88%E5%B9%B6%E5%87%BD%E6%95%B0"><span class="toc-text">9. 字符串拆分合并函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-text">10. 字符串函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9B%BF%E6%8D%A2%E5%87%BD%E6%95%B0"><span class="toc-text">11. 字符串替换函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-text">12. 聚合函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-text">参考文献</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/10/16/reptile_3/" title="Python 爬虫基础之 Selenium 详解"><img src="/img/reptile/1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python 爬虫基础之 Selenium 详解"/></a><div class="content"><a class="title" href="/2023/10/16/reptile_3/" title="Python 爬虫基础之 Selenium 详解">Python 爬虫基础之 Selenium 详解</a><time datetime="2023-10-16T10:02:00.000Z" title="发表于 2023-10-16 18:02:00">2023-10-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/26/clickhouse_17/" title="Clickhouse 常用函数总结"><img src="/img/clickhouse/1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Clickhouse 常用函数总结"/></a><div class="content"><a class="title" href="/2023/09/26/clickhouse_17/" title="Clickhouse 常用函数总结">Clickhouse 常用函数总结</a><time datetime="2023-09-26T07:47:00.000Z" title="发表于 2023-09-26 15:47:00">2023-09-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/21/python_20/" title="Python2.7.5 环境下离线安装 pip 和第三方库"><img src="/img/python/1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python2.7.5 环境下离线安装 pip 和第三方库"/></a><div class="content"><a class="title" href="/2023/07/21/python_20/" title="Python2.7.5 环境下离线安装 pip 和第三方库">Python2.7.5 环境下离线安装 pip 和第三方库</a><time datetime="2023-07-21T07:33:41.000Z" title="发表于 2023-07-21 15:33:41">2023-07-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/07/python_19/" title="Python 脚本之获取 Splunk 数据保存到本地文件"><img src="/img/python/1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python 脚本之获取 Splunk 数据保存到本地文件"/></a><div class="content"><a class="title" href="/2023/06/07/python_19/" title="Python 脚本之获取 Splunk 数据保存到本地文件">Python 脚本之获取 Splunk 数据保存到本地文件</a><time datetime="2023-06-07T04:23:29.000Z" title="发表于 2023-06-07 12:23:29">2023-06-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/17/linux_7/" title="VMware 虚拟机安装 OpenEuler 欧拉系统"><img src="/img/linux/3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="VMware 虚拟机安装 OpenEuler 欧拉系统"/></a><div class="content"><a class="title" href="/2023/05/17/linux_7/" title="VMware 虚拟机安装 OpenEuler 欧拉系统">VMware 虚拟机安装 OpenEuler 欧拉系统</a><time datetime="2023-05-17T08:30:44.000Z" title="发表于 2023-05-17 16:30:44">2023-05-17</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/9.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By 大Null</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://www.program-park.top/2023/09/26/clickhouse_17/'
    this.page.identifier = '/2023/09/26/clickhouse_17/'
    this.page.title = 'Clickhouse 常用函数总结'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }

  document.getElementById('darkmode').addEventListener('click', () => {
    setTimeout(() => window.disqusReset(), 200)
  })
}

if ('Valine' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>